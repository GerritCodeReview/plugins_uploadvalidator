{
  "comments": [
    {
      "key": {
        "uuid": "63e15de4_1e036d87",
        "filename": "src/main/resources/Documentation/config.md",
        "patchSetId": 1
      },
      "lineNbr": 237,
      "author": {
        "id": 1003873
      },
      "writtenOn": "2017-01-13T09:09:07Z",
      "side": 1,
      "message": "We had a different idea on implementing the override logic, just that no one started working on it yet.\n\nThe idea was to use Git notes on a dedicated notes branch, to manage override for particular commits. One note is an override permission for one commit.\n\nAssume the dedicated notes branch is named refs/notes/uploadvalidator/override, a developer needs to push a commit with SHA1\u003dc0ffee.. and that commit doesn\u0027t pass the uploadvalidator validations. In that case a project lead, one who has\npermissions to push to the refs/notes/uploadvalidator/*, creates\na note on the c0ffee SHA1 (in the note content he may write the reason\nfor approving the exception) and pushes that note to Gerrit.\n\nThe uploadvalidator plugin first checks existence of a override note for the received commit. If such a note is present it skips all validations.\n\nThis approach has some advantages:\n* all exceptions are well documented and we also know who created them\n* no need for a new access permission. We use the Push permission on the refs/notes/uploadvalidator/override to control who can approve overrides\n\nWhat do you think?",
      "range": {
        "startLine": 227,
        "startChar": 0,
        "endLine": 237,
        "endChar": 40
      },
      "revId": "56f6efe3aa51a576bd592305370855dace5ef60f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "63e15de4_de20251a",
        "filename": "src/main/resources/Documentation/config.md",
        "patchSetId": 1
      },
      "lineNbr": 237,
      "author": {
        "id": 1003873
      },
      "writtenOn": "2017-01-13T09:11:59Z",
      "side": 1,
      "message": "To add one more advantage:\n\n* We don\u0027t need to assign \"override upload permission\" to a developer who needs to push one such commit and them remember to immediately revoke that permission",
      "range": {
        "startLine": 227,
        "startChar": 0,
        "endLine": 237,
        "endChar": 40
      },
      "revId": "56f6efe3aa51a576bd592305370855dace5ef60f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "83d8113c_5fb96b89",
        "filename": "src/main/resources/Documentation/config.md",
        "patchSetId": 1
      },
      "lineNbr": 237,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2017-01-13T09:21:41Z",
      "side": 1,
      "message": "I think your idea makes sense and adds a more granular ad-hoc override mechanism.\n\nHowever, I would keep the ability to \"globally unlock\" all the upload permissions for admin purposes. Then simply check if the current user is administrator?",
      "range": {
        "startLine": 227,
        "startChar": 0,
        "endLine": 237,
        "endChar": 40
      },
      "revId": "56f6efe3aa51a576bd592305370855dace5ef60f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "83d8113c_1fd603a9",
        "filename": "src/main/resources/Documentation/config.md",
        "patchSetId": 1
      },
      "lineNbr": 237,
      "author": {
        "id": 1003873
      },
      "writtenOn": "2017-01-13T10:45:31Z",
      "side": 1,
      "message": "A problem with the global unlock is that it is really global. If a user gets the \"Override Upload Validation\" capability then this applies to *all* projects for that user and this user can then upload changes to unrelated project(s) and skip all upload validation logic.\n\nI think that having a kind of (project,user) or (project,group) level unlock is what you really need? Right now I don\u0027t have a good proposal how to implement it but I will think about it.",
      "range": {
        "startLine": 227,
        "startChar": 0,
        "endLine": 237,
        "endChar": 40
      },
      "revId": "56f6efe3aa51a576bd592305370855dace5ef60f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "83d8113c_5fd08ba9",
        "filename": "src/main/resources/Documentation/config.md",
        "patchSetId": 1
      },
      "lineNbr": 237,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2017-01-13T10:57:08Z",
      "side": 1,
      "message": "Is it possible to define a plugin-specific permission that is not global? (not a GlobalCpability but a custom permission)",
      "range": {
        "startLine": 227,
        "startChar": 0,
        "endLine": 237,
        "endChar": 40
      },
      "revId": "56f6efe3aa51a576bd592305370855dace5ef60f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "63e15de4_9e2bfde6",
        "filename": "src/main/resources/Documentation/config.md",
        "patchSetId": 1
      },
      "lineNbr": 237,
      "author": {
        "id": 1003873
      },
      "writtenOn": "2017-01-13T14:04:41Z",
      "side": 1,
      "message": "I think this is not possible.\n\nAnother possibility would be to have an ref-pattern exclusion in the per-project plugin\u0027s configuration. The upload validation is skipped for the excluded refs. This way, you could exclude a ref refs/heads/foo from the upload validation, upload the commits to that branch (subject to having Push permission) and then create a merge commit which merges these commits to the target branch?",
      "range": {
        "startLine": 227,
        "startChar": 0,
        "endLine": 237,
        "endChar": 40
      },
      "revId": "56f6efe3aa51a576bd592305370855dace5ef60f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "63e15de4_fe224106",
        "filename": "src/main/resources/Documentation/config.md",
        "patchSetId": 1
      },
      "lineNbr": 237,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2017-01-13T14:10:19Z",
      "side": 1,
      "message": "Nope, it wouldn\u0027t work. The aim is really to avoid people pushing certain files to the repo, regardless of the branch.\n\nWhat about then just skip the validation for the administrators? You do need someone (e.g. Gerrit admin) that is able to work on the repo regardless of the upload validation policies defined.\n\nI am fine as well with the ad-hoc solution you proposed but we need both: permanent and ad-hoc.",
      "range": {
        "startLine": 227,
        "startChar": 0,
        "endLine": 237,
        "endChar": 40
      },
      "revId": "56f6efe3aa51a576bd592305370855dace5ef60f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "83d8113c_7f8c6fd4",
        "filename": "src/main/resources/Documentation/config.md",
        "patchSetId": 1
      },
      "lineNbr": 237,
      "author": {
        "id": 1003873
      },
      "writtenOn": "2017-01-13T14:30:25Z",
      "side": 1,
      "message": "\u003e Nope, it wouldn\u0027t work. The aim is really to avoid people pushing certain files to the repo, regardless of the branch.\n\nI don\u0027t understand that statement. We are discussing how to switch off upload validation for certain users (and thus enable uploading a certain file which otherwise would be rejected by the plugin) and what I proposed is one way of achieving that. What exactly wouldn\u0027t work?",
      "range": {
        "startLine": 227,
        "startChar": 0,
        "endLine": 237,
        "endChar": 40
      },
      "revId": "56f6efe3aa51a576bd592305370855dace5ef60f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "63d6bd38_1699fc59",
        "filename": "src/main/resources/Documentation/config.md",
        "patchSetId": 1
      },
      "lineNbr": 237,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2017-01-14T22:43:13Z",
      "side": 1,
      "message": "\u003e I don\u0027t understand that statement. We are discussing how to switch off upload validation for certain users (and thus enable uploading a certain file which otherwise would be rejected by the plugin) and what I proposed is one way of achieving that. What exactly wouldn\u0027t work?\n\nThe solution you are proposing (one note for a specific commit to override the validation for certain users) is linked to a specific commit only. The situation you have depicted is: \"one dev needs to push a file that would have been blocked by uploadvalidator: the admin by creating one note allows a one-off authorization to override the rules\".\n\nI like the scenario, but it isn\u0027t the one that I want to target for my change.\nI want to *permanently* allow a group of users to override the rules on all projects. E.g. the Gerrit administrators should be able to do whatever, regardless of the uploadvalidator plugin configuration.\n\nYour solution covers the \"ad-hoc\" one-off permission to override, which is different from a permanent authorization to override all rules on all projects.\n\nHope this clarifies.\n\nLuca.",
      "revId": "56f6efe3aa51a576bd592305370855dace5ef60f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "63d6bd38_96c3cc1b",
        "filename": "src/main/resources/Documentation/config.md",
        "patchSetId": 1
      },
      "lineNbr": 237,
      "author": {
        "id": 1003873
      },
      "writtenOn": "2017-01-14T22:57:07Z",
      "side": 1,
      "message": "Luca, have you read my proposal about skipping upload validator checks for a specific branch (or a ref-pattern) in a project and granting the Push permission to those who need to bypass the upload validators?\nThis is different from the one-off permission handled by Git notes and was\nproposed as an alternative to the \"Override Upload Validation\" capability.",
      "revId": "56f6efe3aa51a576bd592305370855dace5ef60f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "63d6bd38_56a65496",
        "filename": "src/main/resources/Documentation/config.md",
        "patchSetId": 1
      },
      "lineNbr": 237,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2017-01-14T23:02:53Z",
      "side": 1,
      "message": "\u003e Luca, have you read my proposal about skipping upload validator checks for a specific branch (or a ref-pattern) in a project and granting the Push permission to those who need to bypass the upload validators?\n\u003e This is different from the one-off permission handled by Git notes and was\n\u003e proposed as an alternative to the \"Override Upload Validation\" \n\nNope, I believe that is the piece of information I\u0027m missing: can you give the link?",
      "revId": "56f6efe3aa51a576bd592305370855dace5ef60f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "43d37948_1599f459",
        "filename": "src/main/resources/Documentation/config.md",
        "patchSetId": 1
      },
      "lineNbr": 237,
      "author": {
        "id": 1003873
      },
      "writtenOn": "2017-01-14T23:06:52Z",
      "side": 1,
      "message": "It is in this discussion thread, my 4th comment counting top to bottom, containing paragraph starting with: \"Another possibility would be to have an ref-pattern exclusion in the per-project plugin\u0027s configuration...\"\n\nWhen I wrote \"subject to having Push permission\" in that comment, then I really meant the Push permission and not a Git note.",
      "revId": "56f6efe3aa51a576bd592305370855dace5ef60f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "43d37948_d5b93cbd",
        "filename": "src/main/resources/Documentation/config.md",
        "patchSetId": 1
      },
      "lineNbr": 237,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2017-01-14T23:26:24Z",
      "side": 1,
      "message": "\u003e It is in this discussion thread, my 4th comment counting top to bottom, containing paragraph starting with: \"Another possibility would be to have an ref-pattern exclusion in the per-project plugin\u0027s configuration...\"\n\u003e \n\u003e When I wrote \"subject to having Push permission\" in that comment, then I really meant the Push permission and not a Git note.\n\nI see, but that was a branch exclusion solution: skip validation for certain branches and then do a merge commit. The goal of my change was to allow global override on all branches of all projects to certain groups.\n\nThe branch exclusion would not satisfy my goal :-(\n\nWhat\u0027s wring with my proposal? It isn\u0027t in contrast with yours, it just achieve a different goal :-)",
      "revId": "56f6efe3aa51a576bd592305370855dace5ef60f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    }
  ]
}